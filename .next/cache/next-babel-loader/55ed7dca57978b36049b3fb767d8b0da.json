{"ast":null,"code":"import config from \"utils/config.js\";\nimport jwt from \"jsonwebtoken\";\nimport User from \"@/model/User\";\nexport const authentication = async token => {\n  if (!token) {\n    throw new Error(\"No token provided\");\n  } else {\n    const data = await jwt.verify(token, config.SECRET);\n\n    if (data) {\n      const user = await User.findOne({\n        _id: data._id\n      }, {\n        password: 0\n      });\n      return user;\n    } else {\n      throw new Error(\"Invalid token\");\n    }\n  }\n};","map":{"version":3,"sources":["/home/peter/Desktop/projects/hela/law-3/src/utils/auth.js"],"names":["config","jwt","User","authentication","token","Error","data","verify","SECRET","user","findOne","_id","password"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,iBAAnB;AACA,OAAOC,GAAP,MAAgB,cAAhB;AACA,OAAOC,IAAP,MAAiB,cAAjB;AAEA,OAAO,MAAMC,cAAc,GAAG,MAAOC,KAAP,IAAiB;AAC7C,MAAI,CAACA,KAAL,EAAY;AACV,UAAM,IAAIC,KAAJ,CAAU,mBAAV,CAAN;AACD,GAFD,MAEO;AACL,UAAMC,IAAI,GAAG,MAAML,GAAG,CAACM,MAAJ,CAAWH,KAAX,EAAkBJ,MAAM,CAACQ,MAAzB,CAAnB;;AACA,QAAIF,IAAJ,EAAU;AACR,YAAMG,IAAI,GAAG,MAAMP,IAAI,CAACQ,OAAL,CAAa;AAAEC,QAAAA,GAAG,EAAEL,IAAI,CAACK;AAAZ,OAAb,EAAgC;AAAEC,QAAAA,QAAQ,EAAE;AAAZ,OAAhC,CAAnB;AACA,aAAOH,IAAP;AACD,KAHD,MAGO;AACL,YAAM,IAAIJ,KAAJ,CAAU,eAAV,CAAN;AACD;AACF;AACF,CAZM","sourcesContent":["import config from \"utils/config.js\";\nimport jwt from \"jsonwebtoken\";\nimport User from \"@/model/User\";\n\nexport const authentication = async (token) => {\n  if (!token) {\n    throw new Error(\"No token provided\");\n  } else {\n    const data = await jwt.verify(token, config.SECRET);\n    if (data) {\n      const user = await User.findOne({ _id: data._id }, { password: 0 });\n      return user;\n    } else {\n      throw new Error(\"Invalid token\");\n    }\n  }\n};\n"]},"metadata":{},"sourceType":"module"}